---
layout: post
title: 피터슨 알고리즘 정리
subtitle: 상호배제 문제를 해결하기 위한 알고리즘 -2
tags: [운영체제]
---
[이전포스팅](/2019-05-01-dekker_algorithm/)에서는 데커 알고리즘에 대해 알아봤다. 오늘은 피터슨 알고리즘에 대해 알아보자!

## 피터슨 알고리즘

개리 피터슨이 제시한 병렬 프로그래밍 알고리즘으로서, 임계구역 해결의 세 가지 조건을 모두 만족한다. 상호 배제를 위한  공유 메모리를 활용하여 여러 개의 프로세스가 하나의 자원을 함께 사용할 때 문제가 발생하지 않도록 해준다. 데커 알고리즘과 비교할 때 `상대방에게 진입 기회를 양보`한다는 특징을 갖고 있다. 하지만 2개의 프로세스만 사용 가능하다는 한계가 있다. 3개 이상의 경우에도 적용할 수 있는 방법이 논의되고 있다고 한다.

![pterson_algorithm](/img/190501/190501_img_1.jpeg)  

turn이라는 공유변수가 추가되었고, lock1가 lock2가 false인 상태이다. 프로세스 P1은 lock1을 true로 설정해 임계 구역에 진입할 것이라고 설정한다. 만약 타임 아웃이 발생하게 되어 프로세스 P2의 차례로 넘어간다면 lock2 또한 true가 된다. 만약 타임아웃이 또 발생하게 된다면 P1으로 넘어가 turn은 2가 되면서, while문의 조건이 충족하게 되어 대기하게 된다. P1이 대기되는 동안 P2의 순서로 넘어가 turn이 1로 변경되면 그 즉시 while문의 조건이 깨지게 되면서 P1은 임계구역에 진입하게 된다. 마찬가지로 P2에서는 while문의 조건이 충족하기 때문에 똑같이 대기하게 된다. 임계구역에서 작업을 마치고 나온 P1은 lock1을 false로 설정하게 되고, 그 즉시 P2의 while 조건이 깨져 임계구역에 진입하고 작업이 끝나면 lock2를 false로 설정한다.

프로세스 P2가 먼저 실행되면서 타임 아웃 문제가 발생하게 되도 turn의 값과 while의 조건으로 인해 반드시 따로 임계 구역에 진입하게 된다. 진입 기회를 양보한다는 것이 무슨 말인지 몰랐었는데, 실행 될 수 있는 경우를 따져가며 천천히 따라가보니 이해 되었다. lock1과 lock2는 누가 임계 구역에 진입할 것인지 나타내는 변수이고, turn은 누가 임계 구역에 들어갈 차례인지 나타내는 변수이다. P1에서는 turn을 2로 (P2가 들어갈 차례로 설정), P2에서는 turn을 1로 (P1이 들어갈 차례로 설정) 선언하여 서로 먼저 들어가라며 양보해주는 것을 알 수 있다. 이 과정에서 만약 문맥 교환(타임 아웃)이 일어나지 않았다면 while문에 갇히게 된다.


[다음엔](/2019-05-01-dekker_algorithm/) 데커 알고리즘에 대해 정리해보도록 하겠다.
