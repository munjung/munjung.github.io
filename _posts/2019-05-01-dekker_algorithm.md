---
layout: post
title: 데커 알고리즘 정리
subtitle: 상호배제 문제를 해결하기 위한 알고리즘 -1
tags: [운영체제]
---

[이전포스팅](/2019-04-29-critical_section/)에서는 임계구역이 무엇인지 알아봤다. 임계구역의 해결 조건 중 `상호 배제`가 가장 큰 이슈였다. 그래서 오늘은 상호 배제를 해결하기 위한 알고리즘에 대해 정리하고자 한다. 대표적인 상호배제 해결 알고리즘으로는 피터슨 알고리즘과 데커 알고리즘이 존재한다. 데커 알고리즘 부터 알아보자!

## 데커 알고리즘

네덜란드의 수학자 테오도루스 데커가 제시한 병행 프로그래밍 알고리즘으로서 상호 배제를 위해 고안하였다. 공유 메모리를 사용하여 두 프로세스가 하나의 자원을 혼란 없이 공유할 수 있게 하는 것을 목적으로 하고 `우선권을 부여`한다는 특징을 갖고 있다. 데커의 알고리즘은 검사 및 조정(test-and-set) 명령과 같은 원자적 명령이 없는 경우에도 사용할 수 있으며, 바쁜 대기(busy waiting) 알고리즘에 속한다.

![dekker_algorithm](/img/190501/190501_img_2.jpeg)  

turn이라는 공유변수가 추가되었고, lock1가 lock2가 false인 상태이다. 프로세스 P1은 lock1을 true로 설정해 임계 구역에 진입할 것이라고 설정한다. 만약 타임 아웃이 발생하게 되어 프로세스 P2의 차례로 넘어간다면 lock2 또한 true가 된다. 타임 아웃이 또 발생하게 되어 P1의 순서로 넘어가게 되면 P1의 while문의 조건이 충족하게 되어 그 안에 들어가게 된다. P2의 while문에서도 동일한 일이 발생한다. 현재 turn의 값은 1이기 때문에 P1의 if문을 빠져나와 while문 안에 계속해서 있게 된다. P2의 if문은 조건이 충족되기 때문에 그 안으로 들어가게 되고, lock2가 false로 바뀌게 된다. 그렇게 되면 P1의 while문 조건이 깨지게 되어 P1은 임계구역에 진입하게 된다. P2 또한 turn이 여전히 1이기 때문에 while문 안에 갇혀있게 된다. 작업을 마친 P1은 임계 구역을 나와 turn을 2로 변경하게 된다. 그러면 P2는 while문에서 빠져나오게 되고, lock2는 true가 된다. P1에서 lock1이 false가 되면 P2의 첫번째 while문 조건이 깨지게 되며 P2도 임계구역에 진입하게 된다. 모든 작업을 마친 P2는 임계구역을 빠져나와 turn을 1로 변경하고 lock2를 false로 설정한다.

프로세스 P2가 먼저 실행되면서 타임아웃이 발생해도 turn의 값과 if문 조건으로 임계 구역에 동시에 진입할 수 없게 된다. lock1과 lock2는 누가 임계 구역에 진입할 것인지 나타내는 변수이고, turn은 누가 임계 구역에 들어갈 차례인지 나타내는 변수이다. turn의 값을 무엇으로 설정하느냐에 따라 어떤 프로세스를 먼저 실행하게 할지 우선권을 부여한다. 두 프로세스 모두 lock을 true로 바꿔 임계 구역에 진입하려고 하려고 해도, if를 통해 누가 먼저 진입하는 지 확인하는 작업을 거친다.
